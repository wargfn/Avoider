package{		/*	...	author:wargfn@wargfndev.blogspot.com	Main Game Loop	*/		import flash.display.MovieClip;	import flash.utils.Timer;	import flash.events.TimerEvent;	import flash.text.TextField;	import Classes.Enemy;	import Classes.Avatar;	import Classes.PixelPerfectCollisionDetection;		public class AvoiderGame extends MovieClip	{				public var army:Array;		public var avatar:Avatar;		public var gameTimer:Timer;		public var playScreen:AvoiderGame;		//public var gameClock:Number;		//public var gameScore:Number;				public function AvoiderGame()		{			/* Originally used to display the			background, but it seems that it was unneeded			playScreen = new PlayScreen();			playScreen.x = 0;			playScreen.y = 0;			addChild(playScreen); */						army = new Array();			//pushing one starting enemy just to be sure			var newEnemy = new Enemy(100, -15);			army.push(newEnemy);			addChild(newEnemy);									avatar = new Avatar();			addChild(avatar);						avatar.x = mouseX;			avatar.y = mouseY;						gameTimer = new Timer( 25 );			gameTimer.addEventListener(TimerEvent.TIMER, onTick);			gameTimer.start();								}				public function getFinalScore():Number		{			return gameScore.currentValue;		}				public function getFinalClockTime():Number		{			return gameClock.currentValue;		}				public function onTick(timerEvent:TimerEvent):void		{						gameClock.addToValue(25);						if ( Math.random() < 0.1)			{								var randomX:Number = Math.random() * 400;				var newEnemy:Enemy = new Enemy(randomX, -15);				army.push(newEnemy);				addChild(newEnemy);				gameScore.addToValue(10);				//trace(randomX.toString());						}						var avatarHasBeenHit:Boolean = false;						for each (var enemy:Enemy in army)			{								enemy.moveABit();							//Old BOX based collions				//if(avatar.hitTestObject(enemy))				if ( PixelPerfectCollisionDetection.isColliding( avatar, enemy, this, true ) )				{									gameTimer.stop();					//dispatchEvent( new AvatarEvent (AvatarEvent.DEAD) );					avatarHasBeenHit = true;								}							}						if(avatarHasBeenHit == true)			{								dispatchEvent(new AvatarEvent(AvatarEvent.DEAD));							}						avatar.x = mouseX;			avatar.y = mouseY;								}			}	}